# Backend (Image Similarity)

This backend provides an image-similarity API using ResNet50 features and an optional Gemini (Gemini 2.5 Flash) integration to generate insights about two images.

## Endpoints

- `GET /` — health check
- `POST /compare/` — upload two images (form-data) and get a similarity score
- `POST /compare_with_insights/` — upload two images (form-data) and get:
  - `similarity_score` (float)
  - `image_a` and `image_b` (base64 data URIs)
  - `insights` (string) — generated by Gemini if configured

## Setup

1. Create a virtual environment and install requirements:

   # PowerShell
   python -m venv .venv; .\.venv\Scripts\Activate; pip install -r requirements.txt

2. Set environment variables. To enable Gemini insights, set your Google API key:

   # PowerShell
   $env:GOOGLE_API_KEY = "YOUR_KEY_HERE"

   Alternatively create a `.env` file with:
   GOOGLE_API_KEY=YOUR_KEY_HERE

### If pip fails to find the Google client package

The Google Generative AI / Gemini client package name may vary by release and PyPI availability. If `pip install -r requirements.txt` fails with a message like "No matching distribution found for google-generative-ai", do the following:

1. Install the package manually (try one of these):

   # PowerShell
   pip install google-genai
   # or
   pip install google-generative-ai

2. If those commands fail, search PyPI or the Google Generative AI docs for the current Python package name. You can also install directly from a wheel or source distribution provided by Google.

3. After installing the client, make sure `GOOGLE_API_KEY` is set and restart the server.

If you'd like, tell me the exact pip error (paste it) and I can suggest the correct package name and update the repo to pin a working version.

3. Run the server:

   # PowerShell
   uvicorn main:app --reload --port 8000

## Notes & assumptions

- The code attempts to import the `google.generativeai` client and call `generate(...)` with `model="gemini-2.5-flash"`.
  If your installed client exposes a different API, adjust `generate_gemini_insights` in `main.py` accordingly.

- The endpoint returns images as base64 data URIs. If you prefer URLs, upload the files to a public store and pass the URLs to Gemini instead.

- Some imports (TensorFlow, scikit-learn, python-dotenv) may need system-specific installation and are not verified in this repository.
